syntax = "proto3";

option go_package = "github.com/tobyrushton/globalfront/pb/messages/v1";

package messages.v1;

import "game/v1/game.proto";

message WebsocketMessage {
    MessageType type = 1;

    oneof payload {
        StartCountdown start_countdown = 2;
        GameStart game_start = 3;
        JoinGame join_game = 4;
        JoinGameResponse join_game_response = 5;
        Spawn spawn = 6;
    }
}

enum MessageType {
    MESSAGE_TYPE_UNSPECIFIED = 0;
    MESSAGE_START_COUNTDOWN = 1;
    MESSAGE_GAME_START = 2;
    MESSAGE_JOIN_GAME = 3;
    MESSAGE_JOIN_GAME_RESPONSE = 4;
    MESSAGE_SPAWN = 5;
}

message StartCountdown {
    int32 countdown_seconds = 1;
}

message GameStart {}

message JoinGame {
    string player_id = 1;
}

message JoinGameResponse {
    repeated game.v1.Player players = 1;
    game.v1.Board board = 2;
}

message Spawn {
    string player_id = 1;
    int32 tile_id = 2;
}
